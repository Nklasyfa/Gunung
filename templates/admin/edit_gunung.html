{% extends "admin/base.html" %}

{% block title %}Edit Gunung{% endblock %}

{% block content %}
<header>
    <h1>Edit Data Gunung: {{ gunung.nama_gunung }}</h1>
    <p>Perbarui informasi gunung di bawah ini.</p>
</header>

<div class="content-card" style="max-width: 800px;">
    
    <form action="{{ url_for('admin.edit_gunung', id=gunung.gunung_id) }}" method="post" enctype="multipart/form-data">
        
        <div class="form-group">
            <label for="nama_gunung">Nama Gunung</label>
            <input type="text" id="nama_gunung" name="nama_gunung" class="form-control" value="{{ gunung.nama_gunung }}" required>
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div class="form-group">
                <label for="lokasi">Lokasi</label>
                <input type="text" id="lokasi" name="lokasi" class="form-control" value="{{ gunung.lokasi }}" required>
            </div>
            <div class="form-group">
                <label for="ketinggian">Ketinggian (MDPL)</label>
                <input type="number" id="ketinggian" name="ketinggian" class="form-control" value="{{ gunung.ketinggian | default(0) }}" required>
            </div>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div class="form-group">
                <label for="latitude">Latitude</label>
                <input type="number" id="latitude" name="latitude" class="form-control" value="{{ gunung.latitude | default('') }}" step="0.0001" required>
            </div>
            <div class="form-group">
                <label for="longitude">Longitude</label>
                <input type="number" id="longitude" name="longitude" class="form-control" value="{{ gunung.longitude | default('') }}" step="0.0001" required>
            </div>
        </div>

        <div class="form-group">
            <label for="status_pendakian">Status Pendakian</label>
            <select id="status_pendakian" name="status_pendakian" class="form-control" required>
                <option value="Dibuka" {{ 'selected' if gunung.status_pendakian == 'Dibuka' }}>Dibuka</option>
                <option value="Ditutup" {{ 'selected' if gunung.status_pendakian == 'Ditutup' }}>Ditutup</option>
                <option value="Ditutup Sebagian" {{ 'selected' if gunung.status_pendakian == 'Ditutup Sebagian' }}>Ditutup Sebagian</option>
            </select>
        </div>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
            <div class="form-group">
                <label for="min_days">Durasi Minimum (hari)</label>
                <input type="number" id="min_days" name="min_days" class="form-control" value="{{ gunung.min_days | default(1) }}" min="1" required>
            </div>
            <div class="form-group">
                <label for="max_days">Durasi Maksimum (hari)</label>
                <input type="number" id="max_days" name="max_days" class="form-control" value="{{ gunung.max_days | default(2) }}" min="1" required>
            </div>
        </div>

        <!-- Estimasi dan kuota sekarang dikelola pada level jalur pendakian -->
        
        <div class="form-group">
            <label for="deskripsi">Deskripsi Singkat</label>
            <textarea id="deskripsi" name="deskripsi" class="form-control">{{ gunung.deskripsi | default('', true) }}</textarea>
        </div>

        <div class="form-group">
            <label for="sejarah">Sejarah Singkat</label>
            <textarea id="sejarah" name="sejarah" class="form-control">{{ gunung.sejarah | default('', true) }}</textarea>
        </div>
        
        <div class="form-group">
            <label for="gambar">Gambar Gunung (ubah jika perlu)</label>
            {% set img_val = gunung.gambar if gunung.gambar is defined else None %}
            {% if img_val %}
                <div style="margin-bottom:8px;">
                    {% if img_val.startswith('uploads/') or img_val.startswith('uploads\\') %}
                        <img src="{{ url_for('static', filename=img_val) }}" alt="Gambar {{ gunung.nama_gunung }}" style="max-width:200px; display:block;" />
                    {% else %}
                        <img src="{{ url_for('static', filename='uploads/gunung/' ~ img_val) }}" alt="Gambar {{ gunung.nama_gunung }}" style="max-width:200px; display:block;" />
                    {% endif %}
                </div>
            {% endif %}
            <input type="file" id="gambar" name="gambar" accept="image/*" class="form-control">
        </div>
        
        <div class="button-group">
            <button type="submit" class="btn primary">Update Perubahan</button>
            <a href="{{ url_for('admin.gunung') }}" class="btn secondary">Batal</a>
        </div>
    </form>
</div>
{% endblock %}